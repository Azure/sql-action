name: pr-test

on:
  pull_request_target:
    types: [labeled, opened]
    branches:
      - master
      - 'releases/*'
      
jobs:

    deploy:
      if: contains(github.event.pull_request.labels.*.name, 'safe to run test')
      runs-on: windows-latest
      steps:
      - name: Checkout from PR branch  
        uses: actions/checkout@v2

      - name: Building latest changes
        run: |
          npm install --prod

      - uses: ./
        with:
          server-name: sql-action-test-server.database.windows.net
          connection-string: ${{â€¯secrets.AZURE_SQL_CONNECTION_STRING }}
          sql-file: ./testsql.sql
